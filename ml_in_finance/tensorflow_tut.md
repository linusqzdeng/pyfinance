```python
import tensorflow as tf
import numpy as np
```


```python
# define the data as constant
X = tf.constant([[0, 1], [2, 3]], tf.float32)
Y = tf.constant([[4], [5]], tf.float32)

# initialising the beta
beta = tf.Variable([[0.01], [0.01]], tf.float32)

# compute the residual
residuals = Y - tf.matmul(X, beta)

residuals

```




    <tf.Tensor: shape=(2, 1), dtype=float32, numpy=
    array([[3.99],
           [4.95]], dtype=float32)>




```python
# rank-3 addition
images = np.random.rand(2, 4, 4)
transform = np.random.rand(2, 4, 4)

images = tf.constant(images, tf.float32)
transform = tf.constant(transform, tf.float32)

addition = tf.add(images, transform)
addition
```




    <tf.Tensor: shape=(2, 4, 4), dtype=float32, numpy=
    array([[[0.6630398 , 1.1542369 , 0.7178622 , 1.2149923 ],
            [1.3111463 , 1.2967427 , 1.6939186 , 1.5453889 ],
            [0.9880742 , 0.9602802 , 0.8544624 , 0.735728  ],
            [0.6819464 , 0.5682168 , 1.5388117 , 0.7973267 ]],
    
           [[0.69467163, 1.1786429 , 0.7274319 , 0.44603   ],
            [0.8026004 , 0.8900992 , 1.0139973 , 0.2869184 ],
            [1.4016023 , 0.93662703, 0.8432279 , 0.43697494],
            [1.3529558 , 0.44281995, 0.5284056 , 0.82471365]]], dtype=float32)>




```python
# rank-4 addition
images = np.random.rand(2, 4, 4, 2)
transform = np.random.rand(2, 4, 4, 2)

images = tf.constant(images, tf.float32)
transform = tf.constant(transform, tf.float32)

addition = tf.add(images, transform)
addition

```




    <tf.Tensor: shape=(2, 4, 4, 2), dtype=float32, numpy=
    array([[[[0.6260457 , 1.1355646 ],
             [0.7329703 , 1.0553142 ],
             [0.72823435, 0.696879  ],
             [1.1101692 , 0.4862362 ]],
    
            [[0.10845772, 1.066894  ],
             [1.037339  , 0.46001235],
             [0.6056307 , 0.93011   ],
             [0.6908863 , 0.82703054]],
    
            [[1.1399679 , 0.81666285],
             [0.8624917 , 1.4848557 ],
             [1.42852   , 1.4586128 ],
             [0.477041  , 0.4836735 ]],
    
            [[0.5976449 , 0.9247024 ],
             [1.2424055 , 0.9814972 ],
             [1.1868832 , 1.0010691 ],
             [0.5724598 , 0.6680153 ]]],
    
    
           [[[0.43265182, 1.1151416 ],
             [0.8530179 , 0.51329917],
             [1.0413061 , 1.8850197 ],
             [0.33539575, 1.0818245 ]],
    
            [[1.4563037 , 0.12964375],
             [0.5606185 , 1.2314956 ],
             [1.6971716 , 0.46745118],
             [1.116049  , 1.6887681 ]],
    
            [[0.9788657 , 0.40156984],
             [1.0309037 , 0.38089266],
             [1.4804091 , 0.3278136 ],
             [1.1007928 , 1.1452084 ]],
    
            [[0.5657518 , 0.95053816],
             [1.4739041 , 1.571321  ],
             [1.1666313 , 1.4313096 ],
             [1.7664218 , 1.1821201 ]]]], dtype=float32)>




```python
tf.random.set_seed(1)

a = tf.random.normal([200])
b = tf.random.normal([200])

c = tf.tensordot(a, b, axes=1)
c.numpy()
```




    -15.284364




```python
images = tf.random.uniform((4, 16, 16))
transform = tf.random.normal((16, 16))

batch_matmul = tf.matmul(images, transform)
batch_elementwise = tf.multiply(images, transform)

print(batch_matmul)
print(batch_elementwise)

```

    tf.Tensor(
    [[[-5.3111033   2.20983    -0.8742196  ... -0.85024554  0.4490175
       -0.74632156]
      [-3.2046633   0.7722125  -1.6923969  ... -0.82774734 -4.1863966
       -1.2336454 ]
      [-6.5630174   3.1934006  -0.93205893 ... -0.7961356   1.1135936
        0.19270098]
      ...
      [-3.3219993   1.7427948   1.7976258  ... -1.7986567  -0.64670825
       -3.1097329 ]
      [-3.7355576   0.6526589  -1.5183977  ... -0.9278606  -0.49279517
       -0.43125725]
      [-2.1643248   1.2542639   0.65444696 ... -2.7711709  -2.7403457
       -0.2105838 ]]
    
     [[-2.0127294   2.535126    0.89846355 ... -1.6500188  -2.5639536
       -0.75288045]
      [-3.3018758   0.69258606 -2.7398138  ... -0.10634658 -3.0068936
       -1.0816443 ]
      [-4.8886495   0.34876508 -2.4191556  ...  1.1097413  -1.1159972
       -3.4196477 ]
      ...
      [-2.8874516   0.8230156  -1.8782297  ... -0.56005913 -0.8954675
       -0.03538597]
      [-2.6401346  -1.0849621  -2.9289787  ... -0.70453495 -0.5083778
       -2.6094048 ]
      [-3.692443   -0.17751288 -0.30683073 ... -2.1165001  -0.52137005
       -1.964876  ]]
    
     [[-2.4878087   0.03165932  0.1036799  ... -1.4760876  -0.7600583
       -1.7579465 ]
      [-4.075784    2.5439012   0.9333186  ... -0.9761426  -1.2351356
       -0.12868774]
      [-3.1834865   2.8180099  -0.5647621  ... -1.2096763  -6.259623
       -1.155664  ]
      ...
      [-2.0098016   0.6748733  -2.3570483  ...  1.2705276  -1.9897215
       -1.6370444 ]
      [-3.1838994   0.7068017  -1.7994361  ...  1.2156686  -0.88711226
       -2.440049  ]
      [-3.2916946  -0.04628557 -2.7576368  ... -0.19176406 -1.2476673
       -2.0788178 ]]
    
     [[-2.3672342   0.41115105 -0.40441602 ... -1.0231687  -1.9760165
       -1.6137679 ]
      [-4.547798    2.4080884  -1.8955748  ... -0.84914243 -3.2651167
       -0.57947975]
      [-5.0739093   1.5309879   0.32154617 ... -1.9956539  -2.4904513
       -1.7138972 ]
      ...
      [-0.91600883  1.2545012  -1.3945788  ... -0.4812224  -3.9547138
        0.6505951 ]
      [-1.4696293   1.1740261  -0.04091255 ... -1.3064773  -3.0589628
        0.21114361]
      [-1.8779782   1.331513    1.6586074  ... -1.7656589  -2.093429
       -1.1202269 ]]], shape=(4, 16, 16), dtype=float32)
    tf.Tensor(
    [[[-0.35693273  1.4984343   0.5704315  ... -0.7328836  -0.0091179
        0.6523703 ]
      [-0.02473327 -0.33624747 -1.0452659  ... -0.45544168  2.1892512
       -0.31200132]
      [ 0.11777002  1.084481    0.15496716 ...  0.53446966 -0.08988591
       -0.03752549]
      ...
      [-1.2711288  -0.5622968   1.252301   ... -1.0932542   0.5315649
       -0.04919289]
      [ 0.09937806  0.49190158  0.03120818 ... -1.8246528  -0.06792448
        0.05977784]
      [-0.41531542  0.5546451  -0.07345459 ...  0.7351151   0.05901667
       -0.06055731]]
    
     [[-0.3265412   1.4145492   0.61685914 ... -0.24879712 -0.28618234
        0.46843627]
      [-0.25078216 -0.41348162 -0.01895519 ... -0.44093585  0.63355845
       -1.0513145 ]
      [ 0.01818347  0.00919084  0.37171113 ...  0.6979904  -0.19252704
       -0.0369287 ]
      ...
      [-0.93216604 -0.43723598  0.93196005 ... -0.4515647   0.10276359
       -0.7684625 ]
      [ 0.06102951  0.8582204   1.0333027  ... -1.2012364  -1.1987371
        0.01200537]
      [-0.05601385  0.6880816  -0.25539586 ...  0.522106    0.049885
       -0.03075121]]
    
     [[-0.00221157  1.2884052   0.45699996 ... -0.7245945  -0.3200733
        0.20929839]
      [-0.05285838 -0.3596947  -1.2432369  ... -0.76429784  1.2450038
       -1.053613  ]
      [ 0.1333128   0.3867514   0.44508377 ...  0.39285314 -1.3178592
       -0.03771763]
      ...
      [-0.1680986  -0.15691131  0.97040725 ... -0.08292037  0.20320356
       -1.0645859 ]
      [ 0.03351286  0.69263893  1.0901093  ... -1.3475715  -0.11703455
        0.06069734]
      [-0.21634237  0.71392024 -0.63564676 ...  0.49856874  0.01763689
       -0.12492844]]
    
     [[-0.07438771  0.9452956   0.7518786  ... -0.8513455  -0.21027721
        0.60894114]
      [-0.02402561 -0.52296597 -0.6894135  ... -0.04144482  2.156711
       -0.9146501 ]
      [ 0.06272437  0.7261759   0.09900677 ...  0.6996605  -1.0154735
       -0.0113487 ]
      ...
      [-0.8772768  -0.05061954  0.23052678 ... -0.07242717  0.6101958
       -0.6603832 ]
      [ 0.09005588  0.7718423   0.6789037  ... -1.0059521  -0.6719264
        0.01361593]
      [-0.28154156  0.55466133 -0.5637253  ...  0.7202142   0.05069226
       -0.00757672]]], shape=(4, 16, 16), dtype=float32)



```python

```
